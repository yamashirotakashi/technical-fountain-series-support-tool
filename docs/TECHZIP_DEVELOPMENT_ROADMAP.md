# TechZip 次期開発ロードマップ

最終更新: 2025-01-27

## 概要

技術の泉シリーズ制作支援ツール（TechZip）の機能拡張および関連ツール開発計画。統合・分離戦略の検証結果に基づき、効率的かつ安全なツール群の構築を目指す。

## 開発方針

### 基本原則
1. **責務の明確な分離** - 各ツールは単一の明確な目的を持つ
2. **最小権限の原則** - 必要最小限の権限のみを付与
3. **ユーザー体験の最適化** - 役割に応じた適切なインターフェース
4. **段階的な実装** - 優先度の高い機能から順次リリース

## Phase 1: TechZip Slack統合（2025年2月）

### 概要
TechZipにSlack投稿機能を統合し、PDF生成から配布までのワークフローを自動化。新規にSlack Botを作成。

### 実装内容

#### 1.0 事前準備: Bot作成と一括チャネル登録
```python
# Step 1: Slack App/Bot作成
- Slack App作成（https://api.slack.com/apps）
- Bot User作成とOAuth Scopes設定
  - files:write      # PDF投稿（Phase 1）
  - chat:write       # メッセージ投稿（Phase 1）
  - groups:read      # プライベートチャネル読取（Phase 1）
  - groups:write     # チャネル作成・設定（Phase 2用）
  - incoming-webhook # GitHub通知受信（Phase 2用）
- ワークスペースへのインストール
- Bot Token取得

# Step 2: 既存の多数のプライベートチャネルへBotを一括参加
- 管理者権限での一括招待スクリプト実行
- 対象: 全ての技術の泉プロジェクトチャネル
- 実行タイミング: Slack統合機能実装前
```

#### 1.1 Slack投稿機能
```python
# 追加機能
- PDF生成完了後の自動Slack投稿
- 投稿先チャネルの自動判定（リポジトリ名 = チャネル名）
- 定型文テンプレートによるメッセージ生成
- 投稿成功/失敗の通知
```

#### 1.2 GUI拡張
- メインウィンドウに「Slack投稿設定」セクション追加
- 「完了後Slackに投稿」チェックボックス
- 投稿メッセージのプレビュー機能
- Bot設定画面（初回のみ）

#### 1.3 設定管理
```json
// config/settings.json への追加
{
  "slack": {
    "enabled": false,
    "bot_token": "暗号化して保存",
    "default_message_template": "📚 {book_title} のPDFが更新されました",
    "auto_post": true
  }
}
```

### 技術仕様
- **依存ライブラリ**: slack-sdk
- **必要な権限**: 新規Slack Bot作成（Phase 1+2の全権限を事前設定）
  - Phase 1: files:write, chat:write, groups:read
  - Phase 2用: groups:write, incoming-webhook
- **推定作業量**: 200行程度の追加
- **リスク**: 低（既存機能への影響最小）

### テスト計画
1. 単体テスト: Slack API モックを使用
2. 統合テスト: テスト用Slackチャネルで実施
3. 受け入れテスト: 実際のプロジェクトで検証

## Phase 2: TechZip Admin 開発（2025年3月）

### 概要
プロジェクト初期化専用の管理者ツールを新規開発。高権限操作を安全に実行。

### 基本設計

#### 2.1 アーキテクチャ
```
TechZip Admin/
├── src/
│   ├── core/
│   │   ├── project_initializer.py  # Phase 1で設計済み
│   │   ├── slack_manager.py
│   │   └── github_manager.py
│   ├── gui/
│   │   ├── admin_window.py
│   │   └── auth_dialog.py
│   └── cli/
│       └── admin_cli.py  # GUI/CLI両対応
├── config/
│   └── admin_settings.json
└── requirements.txt
```

#### 2.2 主要機能
1. **プロジェクト一括作成**
   - Slack/GitHub同名リソース作成
   - 設定とREADMEの自動生成
   - GitHub Webhook設定（Push/Issueのみ）

2. **著者管理**
   - 既知の著者データベース
   - GitHubユーザー名とメールのマッピング
   - 一括招待機能

3. **セキュリティ機能**
   - 二要素認証サポート
   - 操作ログの完全記録
   - ロールベースアクセス制御

### 実装優先度
1. **必須機能**（Phase 2.1）
   - 基本的なプロジェクト作成
   - エラーハンドリング
   - ログ記録

2. **追加機能**（Phase 2.2）
   - 著者データベース
   - バッチ処理
   - 高度な設定オプション

## Phase 3: 統合とエコシステム構築（2025年4月）

### 3.1 共通ライブラリ化
```python
# techzip-common パッケージ
techzip_common/
├── config/  # 設定管理
├── auth/    # 認証処理
└── utils/   # 共通ユーティリティ
```

### 3.2 ツール間連携
- Phase 1で作成したPDF投稿Botを活用（権限は作成時に設定済み）
- 設定ファイルの共有仕様策定
- API仕様の定義（将来の拡張用）
- ドキュメント自動生成

## 実装スケジュール

### 2025年2月
- [ ] Week 1: Slack Bot作成とチャネル一括登録
  - [ ] Slack App作成（api.slack.com）
  - [ ] Bot User設定とOAuth Scopes設定
  - [ ] ワークスペースインストールとToken取得
  - [ ] 管理者権限での一括招待スクリプト作成・実行
  - [ ] 全プロジェクトチャネルへの参加確認
- [ ] Week 2: Slack統合の基本実装
- [ ] Week 3: GUI統合とテスト
- [ ] Week 4: 本番環境でのテストとリリース

### 2025年3月
- [ ] Week 1-2: TechZip Admin 基本設計
- [ ] Week 3-4: コア機能実装

### 2025年4月
- [ ] Week 1-2: セキュリティ強化
- [ ] Week 3-4: 統合テストとリリース

## リスク管理

### 技術的リスク
1. **Slack API変更**
   - 対策: SDKの定期更新
   - 影響: 低

2. **権限管理の複雑化**
   - 対策: 明確な権限分離
   - 影響: 中

### 運用リスク
1. **誤操作によるチャネル/リポジトリ作成**
   - 対策: 確認ダイアログ、ドライラン機能
   - 影響: 高

2. **トークン漏洩**
   - 対策: 暗号化保存、定期ローテーション
   - 影響: 高

## 成功指標

### Phase 1（Slack統合）
- PDF生成→Slack投稿の作業時間: 5分 → 0分（自動化）
- エラー率: 1%未満
- ユーザー満足度: 90%以上

### Phase 2（Admin Tool）
- プロジェクト初期化時間: 30分 → 3分
- 設定ミス: ゼロ
- 管理者の作業負荷: 90%削減

## 次のアクション

### 直近のタスク（[techzip]作業時）
1. Slack統合のプロトタイプ実装開始
2. 既存コードベースの整理（リファクタリング）
3. テスト環境の準備

### 準備作業
1. Slack Appの権限拡張申請
2. テスト用Slackチャネルの作成
3. 設計レビューの実施

---

**注記**: このロードマップは2025-01-27の検証結果に基づく。実装時は最新の要件を確認すること。