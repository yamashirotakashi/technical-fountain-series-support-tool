# sample4.pdf コードブロックはみ出し検出レポート

作成日: 2025-07-29

## 🎯 検出結果サマリー

### 検出統計
- **総ページ数**: 132ページ
- **はみ出し検出ページ数**: 3ページ
- **座標ベース検出**: 3ページ
- **視覚的判断検出**: 0ページ（sample4.pdfは新規のため既知データなし）
- **ハイブリッド検出**: 0ページ

### 除外された日本語文字
- ひらがな: 426文字
- 漢字: 276文字  
- カタカナ: 154文字
- その他: 106文字
- **合計**: 962文字

## 📊 検出ページの詳細

### はみ出し検出ページ: 27, 73, 75

#### ページ 27 (奇数ページ)
- **検出内容**: HTMLスタイル属性の長い文字列
- **はみ出しテキスト**: `ght:0pt;margin-top:0pt;margin-bottom:0pt;text-indent:9pt;font-family:&amp;apos;`
- **超過量**: 369.6pt（79文字）
- **特徴**: HTMLの埋め込みスタイルシートで、改行されていない長大な属性値

#### ページ 73 (奇数ページ)
- **検出件数**: 2件
1. `atus"]` - 28.2pt超過（6文字）
2. `um"]["docID"])` - 61.0pt超過（13文字）
- **特徴**: 配列アクセスやメソッド呼び出しの末尾部分

#### ページ 75 (奇数ページ)
- **検出内容**: `atus"]` - 28.2pt超過（6文字）
- **特徴**: ページ73と同じパターン（おそらく同じコードの別箇所）

## 🔍 技術的分析

### 1. 検出パターンの特徴
- **長大な文字列**: ページ27のHTMLスタイル属性（369.6pt超過）
- **配列/オブジェクトアクセス**: ページ73, 75の`atus"]`パターン
- **すべて奇数ページ**: 右ページでの検出（右マージン20mm）

### 2. sample3.pdfとの比較
| 項目 | sample3.pdf | sample4.pdf |
|-----|------------|------------|
| 総ページ数 | 132 | 132 |
| 検出ページ数 | 24 | 3 |
| 検出率 | 18.2% | 2.3% |
| 最大超過量 | 846.7pt | 369.6pt |
| 除外日本語文字 | 516 | 962 |

### 3. 検出の少なさの理由
1. **コード品質が高い**: 適切な改行とインデントが施されている
2. **日本語コメントが多い**: 962文字の日本語が除外（sample3.pdfの約2倍）
3. **長大な文字列が少ない**: JSON、ログ等の長い文字列が少ない

## 💡 推奨事項

### 1. 緊急対応ページ
- **ページ27**: HTMLスタイル属性の改行を検討（369.6pt超過は視認性に大きく影響）

### 2. 軽微な調整
- **ページ73, 75**: 配列アクセス部分の微調整（28-61pt程度の超過）

### 3. 全体的な評価
sample4.pdfは比較的良好な状態で、はみ出しは3ページのみ。特にページ27の長大なHTML属性以外は軽微な問題。

## 📈 次のステップ

1. **目視確認**: 検出された3ページの実際の表示を確認
2. **視覚的判断の追加**: 目視で追加のはみ出しが見つかった場合は、以下のコマンドで登録：
   ```bash
   python visual_hybrid_detector_v4.py --add-overflow sample4.pdf [ページ番号]
   ```
3. **誤検知の報告**: 実際にははみ出していないページがある場合：
   ```bash
   python visual_hybrid_detector_v4.py --add-false-positive sample4.pdf [ページ番号]
   ```

## 🎆 結論

sample4.pdfは全体的に良好な品質で、検出されたはみ出しは3ページのみ。主な問題はページ27のHTML属性の長大な文字列で、これは改行により容易に解決可能。日本語文字を適切に除外することで、実質的な問題のあるコード部分のみを検出できている。